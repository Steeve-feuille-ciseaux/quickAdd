{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <title>Liste des élèves inscrits</title>
    <link rel="stylesheet" href="{% static 'css/liste.css' %}">
</head>
<body>
    <div class="container">
        <h1>Club informatique</h1>
        <button onclick="window.print()" style="margin-bottom: 20px; padding: 8px 16px; font-size: 1rem; cursor: pointer;">
        Imprimer la liste
        </button>

        <a href="{% url 'export_word' %}" 
        style="display:inline-block; margin-left: 20px; padding: 8px 16px; background:#2980b9; color:white; text-decoration:none; font-weight:600; border-radius:4px;">
        Exporter en Word
        </a>

        {% if etudiants %}
            <!-- Tableau résumé -->
            <table>
                <thead>
                    <tr>
                        <th>Total inscrits</th>
                        {% for niveau, count in inscrits_par_niveau.items %}
                            <th>{{ niveau }}ième</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>{{ total_inscrits }}</td>
                        {% for niveau, count in inscrits_par_niveau.items %}
                            <td>{{ count }}</td>
                        {% endfor %}
                    </tr>
                </tbody>
            </table>

            <!-- Tableau détails étudiants -->
            <table>
                <thead>
                    <tr>
                        <th>Prénom</th>
                        <th>Nom</th>
                        <th>Classe</th>
                        <th>Thème</th>
                        <th>Date d'inscription</th>  <!-- ✅ Nouvelle colonne -->
                    </tr>
                </thead>
                    <tbody>
                        {% for item in etudiants %}
                            {% with etudiant=item.instance %}
                            <tr>
                                <td>{{ etudiant.prenom }}</td>
                                <td>{{ etudiant.nom }}</td>
                                <td>{{ etudiant.niveau }} {{ etudiant.classe|upper }}</td>
                                <td>{{ etudiant.get_theme_display }}</td>
                                <td>
                                    {{ etudiant.date_inscription|date:"d/m/Y" }}
                                    {{ item.delai }}
                                </td>
                            </tr>
                            {% endwith %}
                        {% endfor %}
                    </tbody>
            </table>
        {% else %}
            <p>Aucun étudiant inscrit.</p>
        {% endif %}

        <a href="{% url 'ajouter_etudiant' %}">Ajouter un élève</a>
    </div>
</body>
</html>
